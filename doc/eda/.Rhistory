df_resume <- read_csv('../../SharePoint/HR Analytics - Documents/Capstone Data/ubc_mds_team_share/02_eda_data/output/train_dataset.csv')
source('C:/Users/NIY/591_capstone_2020-glentel-mds/eda/04_EDA.R', echo=TRUE)
df_resume <- clean_names(df_resume)
head(df_resume)
employee_code <- df_resume$employee_code
employee_code
term_counts <- new_hire %>%
select(employee_code, terminated) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(terminated) %>%
count()
employee_code_t <- df_resume$employee_code
term_counts <- new_hire %>%
select(employee_code, terminated) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(terminated) %>%
count()
term_counts <- new_hire %>%
select(employee_code, terminated) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(terminated) %>%
count()
ggplot(term_counts, aes(x=terminated, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
employee_code_t
head(new_hire)
term_counts <- new_hire %>%
select(employee_code, position_status) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(position_statusd) %>%
count()
## counts of employees termination filter by high and low performers after
term_counts <- new_hire %>%
select(employee_code, position_status) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(position_status) %>%
count()
ggplot(term_counts, aes(x=terminated, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
## counts of employees termination filter by high and low performers after
term_counts <- new_hire %>%
select(employee_code, position_status) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(position_status) %>%
count()
ggplot(term_counts, aes(x=position_status, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
## termination reasons, filter train set
term_reason_count <- new_hire %>%
select(employee_code, termination_reason_description) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_reason_description) %>%
count() %>%
drop_na()
ggplot(term_reason_count, aes(x=termination_reason_description, y=n))+
geom_bar(position="dodge", stat="identity")+
coord_flip()+
theme_minimal()
dist_jobtitle_changes <- with(active_leave, tapply(job_title, employee_code, FUN = function(x) length(unique(x))))
jobtitle_change <- tibble(employee_code = unique(active_leave$employee_code), num_jobtitle_change = dist_jobtitle_changes)
count_job_title <- jobtitle_change %>%
filter(employee_code %in% employee_code_t) %>%
group_by(num_jobtitle_change) %>%
count()
ggplot(count_job_title, aes(x=num_jobtitle_change, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
library(tidyverse)
library(readxl)
library(janitor)
# load sheets
active_leave <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Active + Leave (Weekly) - 2020_04_28.xlsx')
active_leave <- clean_names(active_leave)
new_hire <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/New Hires - 2020.04.28.xlsx')
new_hire <- clean_names(new_hire)
#grab employee code
df_resume <- read_csv('../../SharePoint/HR Analytics - Documents/Capstone Data/ubc_mds_team_share/02_eda_data/output/train_dataset.csv')
df_resume <- clean_names(df_resume)
employee_code_t <- df_resume$employee_code
term <- read_xlsx("../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Terminations - 2020.04.28.xlsx")
term <- clean_names(term)
head(term)
term_counts <- new_hire %>%
select(employee_code) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
ggplot(term_counts, aes(x=position_status, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_counts <- new_hire %>%
select(employee_code) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
ggplot(term_counts, aes(x=employee_codes, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_counts <- term %>%
select(employee_code) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
term_counts
str(term)
term_reason_count <- term %>%
select(employee_code, termination_type) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type) %>%
count() %>%
drop_na()
ggplot(term_reason_count, aes(x=termination_type, y=n))+
geom_bar(position="dodge", stat="identity")+
coord_flip()+
theme_minimal()
df_resume
left_join(df_resume, term, by="employee_code")
term_join <- left_join(df_resume, term, by="employee_code")
structure(term_join)
term_counts <- term %>%
select(employee_code, termination_type) %>%
# distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
term %>%
select(employee_code, termination_type) %>%
# distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
term_counts <- term_join %>%
select(employee_code, termination_type) %>%
# distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
str(term_join)
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
# distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
term_counts
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(employee_code) %>%
count()
term_counts
length(df_resume$employee_code)
length(distinct(df_resume$employee_code))
length(unique(df_resume$employee_code))
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
ggplot(term_counts, aes(x=employee_codes, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
replace_na(termination_type.y = "Active")
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
## counts of employees termination filter by high and low performers after
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
replace_na(termination_type.y = "Active") %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
replace_na("Active") %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
## counts of employees termination filter by high and low performers after
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
replace_na(list(termination_type.y = "Active")) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
mutate(termination_type.y = case_when(termination_type.y == 'NA' ~ 'Active',
TRUE ~ termination_type.y)) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
mutate(termination_type.y = case_when(termination_type.y == NA ~ 'Active',
TRUE ~ termination_type.y)) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
levels(term_join$termination_reason.y)
unique(term_join$termination_reason.y)
unique(term_join$termination_type.x)
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
mutate(termination_type.y = case_when(termination_type.y == NA ~ 'Active',
TRUE ~ termination_type.y)) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts
term_counts <- term_counts[is.na(term_counts)] = "Active"
term_counts[is.na(term_counts)] = "Active"
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
jobtitle_change
jobtitle_change_join <- left_join(df_resume, jobtitle_change, by = "employee_code")
jobtitle_change_join
count_job_title <- jobtitle_change_join %>%
filter(employee_code %in% employee_code_t) %>%
group_by(num_jobtitle_change) %>%
count()
count_job_title <- jobtitle_change_join %>%
filter(employee_code %in% employee_code_t) %>%
group_by(num_jobtitle_change) %>%
count()
ggplot(count_job_title, aes(x=num_jobtitle_change, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
jobtitle_change_join
count_job_title
ggplot(count_job_title, aes(x=num_jobtitle_change, y=n()))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=num_jobtitle_change, y=n()))+
geom_histogram(position="dodge", stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=num_jobtitle_change, y=n()))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=num_jobtitle_change))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=num_jobtitle_change))+
geom_histogram()+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=num_jobtitle_change))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change)))+
geom_bar(stat="identity")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change)))+
geom_histogram()+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change)))+
geom_bar(stat="count")+
theme_minimal()
jobtitle_change_join
view(jobtitle_change_join)
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change), fill=job_title))+
geom_bar(stat="count")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change), fill=job_title))+
geom_bar(stat="count")+
xlab("Number of Job Changes")+
theme_minimal()
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change), fill=job_title))+
geom_bar(stat="count")+
xlab("Number of Job Changes")+
theme_minimal()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
# load sheets
active_leave <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Active + Leave (Weekly) - 2020_04_28.xlsx')
active_leave <- clean_names(active_leave)
new_hire <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/New Hires - 2020.04.28.xlsx')
new_hire <- clean_names(new_hire)
#grab employee code
df_resume <- read_csv('../../SharePoint/HR Analytics - Documents/Capstone Data/ubc_mds_team_share/02_eda_data/output/train_dataset.csv')
df_resume <- clean_names(df_resume)
employee_code_t <- df_resume$employee_code
dist_jobtitle_changes <- with(active_leave, tapply(job_title, employee_code, FUN = function(x) length(unique(x))))
jobtitle_change <- tibble(employee_code = unique(active_leave$employee_code), num_jobtitle_change = dist_jobtitle_changes)
jobtitle_change_join <- left_join(df_resume, jobtitle_change, by = "employee_code")
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change), fill=job_title))+
geom_bar(stat="count")+
xlab("Number of Job Changes")+
theme_minimal()
## termination reasons, filter train set
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts[is.na(term_counts)] = "Active"
ggplot(term_counts, aes(x=termination_type.y, y=n))+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
## termination reasons, filter train set
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts[is.na(term_counts)] = "Active"
ggplot(term_counts, aes(x=termination_type.y, y=n))+
xlab("Termination Type")
geom_bar(position="dodge", stat="identity")+
theme_minimal()
## termination reasons, filter train set
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts[is.na(term_counts)] = "Active"
ggplot(term_counts, aes(x=termination_type.y, y=n))+
xlab("Termination Type")+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_reason_count <- term %>%
select(employee_code, termination_type) %>%
filter(employee_code %in% employee_code_t) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type) %>%
count() %>%
drop_na()
ggplot(term_reason_count, aes(x=termination_type, y=n))+
geom_bar(position="dodge", stat="identity")+
coord_flip()+
theme_minimal()
dist_jobtitle_changes <- with(active_leave, tapply(job_title, employee_code, FUN = function(x) length(unique(x))))
jobtitle_change <- tibble(employee_code = unique(active_leave$employee_code), num_jobtitle_change = dist_jobtitle_changes)
jobtitle_change_join <- left_join(df_resume, jobtitle_change, by = "employee_code")
ggplot(jobtitle_change_join, aes(x=as.factor(num_jobtitle_change), fill=job_title))+
geom_bar(stat="count")+
xlab("Number of Job Changes")+
theme_minimal()
view(term_join)
term_join$termination_type.x
term_join %>%
filter(termination_type.x == "Resignation")
select(tenure_at_termination.x)
term_join$tenure_at_termination.x
term_join %>%
filter(termination_type.x == "Resignation") %>%
select(tenure_at_termination.x)
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_histogram()
term_long <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(tenure_at_termination.x)
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_histogram()
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_bar(stat = "count")
ggplot(term_long, aes(x=as.numeric(tenure_at_termination.x)))+
geom_bar(stat = "count")
type(tenure_at_termination.x)
typeof(term_long$tenure_at_termination.x)
term_long$tenure_at_termination.x
split(term_long$tenure_at_termination.x, " ")[1]
split(term_long$tenure_at_termination.x, " ")[[1]]
sapply(tenure_at_termination.x, nums)
nums <- function(my.string){
unlist(strsplit(my.string, " "))[1]
}
sapply(tenure_at_termination.x, nums)
sapply(term_long$tenure_at_termination.x, nums)
sapply(term_long$tenure_at_termination.x, nums)
sub(" .*", "", term_long$tenure_at_termination.x)
term_long <- sub(" .*", "", term_long$tenure_at_termination.x)
term_long <- as.numeric(term_long)
term_long <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(tenure_at_termination.x)
term_long$tenure_at_termination.x <- sub(" .*", "", term_long$tenure_at_termination.x)
term_long$tenure_at_termination.x <- as.numeric(term_long)
term_long$tenure_at_termination.x <- sub(" .*", "", term_long$tenure_at_termination.x)
term_long <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(tenure_at_termination.x)
term_long$tenure_at_termination.x <- sub(" .*", "", term_long$tenure_at_termination.x)
term_long
term_long$tenure_at_termination.x <- as.numeric(term_long$tenure_at_termination.x
ggplot(term_long, aes(tenure_at_termination.x))+
geom_bar(stat = "count")
term_long <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(tenure_at_termination.x)
term_long$tenure_at_termination.x <- sub(" .*", "", term_long$tenure_at_termination.x)
as.numeric(term_long$tenure_at_termination.x)
term_long$tenure_at_termination.x <- as.numeric(term_long$tenure_at_termination.x)
term_long$tenure_at_termination.x
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_bar(stat = "count")
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_histogram(stat = "count")
ggplot(term_long, aes(x=tenure_at_termination.x))+
geom_histogram()
term_join$max_hire_date - term$termination_date
term_diff_day <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(max_hire_date, termination_date.y)
term_diff_day
term_diff_day <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(max_hire_date, termination_date.x)
term_diff_day
term_diff_day$max_hire_date - term_diff_day$termination_date.x
term_diff_day$termination_date.x - term_diff_day$max_hire_date
term_diff_day <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(max_hire_date, termination_date.x) %>%
mutate(tenure = termination_date.x - max_hire_date)
term_diff_day <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(max_hire_date, termination_date.x) %>%
mutate(tenure = termination_date.x - max_hire_date)
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()+
geom_vline(X=90, color=red)
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()+
geom_vline(X=90, color="red")
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()+
geom_vline(xintercept = =90, color="red")
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()+
geom_vline(xintercept=90, color="red")
## termination reasons, filter train set
term_counts <- term_join %>%
select(employee_code, termination_type.y ) %>%
distinct(employee_code, .keep_all = TRUE) %>%
group_by(termination_type.y) %>%
count()
term_counts[is.na(term_counts)] = "Active"
ggplot(term_counts, aes(x=termination_type.y, y=n))+
xlab("Termination Type")+
geom_bar(position="dodge", stat="identity")+
theme_minimal()
term_diff_day <- term_join %>%
filter(termination_type.x == "Resignation") %>%
select(max_hire_date, termination_date.x) %>%
mutate(tenure = termination_date.x - max_hire_date)
ggplot(term_diff_day, aes(x=tenure))+
geom_histogram()+
geom_vline(xintercept=90, color="red")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
# load sheets
active_leave <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Active + Leave (Weekly) - 2020_04_28.xlsx')
active_leave <- clean_names(active_leave)
new_hire <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/New Hires - 2020.04.28.xlsx')
new_hire <- clean_names(new_hire)
#grab employee code
df_resume <- read_csv('../../SharePoint/HR Analytics - Documents/Capstone Data/ubc_mds_team_share/02_eda_data/output/train_dataset.csv')
df_resume <- clean_names(df_resume)
employee_code_t <- df_resume$employee_code
term_join <- left_join(df_resume, term, by="employee_code")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(janitor)
# load sheets
active_leave <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Active + Leave (Weekly) - 2020_04_28.xlsx')
active_leave <- clean_names(active_leave)
new_hire <- read_xlsx('../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/New Hires - 2020.04.28.xlsx')
new_hire <- clean_names(new_hire)
#grab employee code
df_resume <- read_csv('../../SharePoint/HR Analytics - Documents/Capstone Data/ubc_mds_team_share/02_eda_data/output/train_dataset.csv')
df_resume <- clean_names(df_resume)
employee_code_t <- df_resume$employee_code
term <- read_xlsx("../../SharePoint/HR Analytics - Documents/Capstone Data/V2 data 5.1.2020/Terminations - 2020.04.28.xlsx")
term <- clean_names(term)
term_join <- left_join(df_resume, term, by="employee_code")
